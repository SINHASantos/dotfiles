#!/usr/bin/env ruby

require 'thor'

class MyCLI < Thor
  desc "symlink", "Symlink files matching *.symlink into ~/"
  def symlink
    Dir.glob("*.symlink").each do |path|
      link "~/dotfiles/#{path}", "~/.#{path.sub(".symlink", "")}"
    end
  end

  desc "compile-commandt", "Compile Command-T extension"
  def compile_commandt
    system "cd ~/.vim/bundle/command-t/ruby/command-t; ruby extconf.rb; make"
  end

  desc "update-homebrew", "Update the list of things installed with Homebrew"
  def update_homebrew
    File.write "homebrew/brews", `brew list`
    File.write "homebrew/cask-apps", `brew cask list`
  end

  private

  def link path, destination
    system "rm -rf #{destination}"
    system "ln -s #{path} #{destination}"
  end
end

MyCLI.start(ARGV)
