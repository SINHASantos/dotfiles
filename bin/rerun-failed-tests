#!/usr/bin/env ruby
# Copy failed rspec tests like:
#
# rspec ./spec/requests/opponent_joined_league_notifier_spec.rb:40 # OpponentJoinedLeagueNotifier might send a notification when a player joins a team in your league
# rspec ./spec/requests/opponent_joined_league_notifier_spec.rb:7 # OpponentJoinedLeagueNotifier sends a notification when a player joins an empty team in your league
# rspec ./spec/controllers/me_controller_spec.rb:5 # MeController#show should require authentication for :get and :show
# rspec ./spec/controllers/me_controller_spec.rb:18 # MeController#update should require authentication for :patch and :update
# rspec ./spec/requests/add_users_to_team_spec.rb:88 # GET /team/:slug/add_users busts the cache of the user adding
# rspec ./spec/requests/errors_spec.rb:30 # Getting errors unauthorized responds with a nice error
#
# And thiss script will rerun just those tests

files = `pbpaste`.lines.map(&:chomp).reject(&:empty?).map { |line|
  line.match(/rspec \.\/(?<file>.*) #/)[:file]
}.join(" ")

if system "script/test #{files}"
  exit 0
else
  exit 1
end
